
# 第一章

_计算机系统是由硬件和软系统软件_共同组成的，他们共同工作来运行来运行应用程序，虽然系统的具体实现方式随着时间不断变化，但是系统内在的概念却没有发生改变。所有计算机系统都有相似的硬件和软件组成，他们又执行着相似的功能。

看本书的目的：**完全理解底层计算机系统以及它对应用程序的影响**。从某种意义上来说，这本书的目的就是要帮助你理解当你在计算机系统上执行hello程序时，系统发生了什么以及为什么会这样。

> 从它被程序员创建开始，到在系统上运行，输出简单的消息，然后终止。我们将沿着这个程序的生命周期，简单的介绍一些逐步出现的关键概念、专业术语、和组成部分。后面的章节也将围绕这些内容展开。

    #include <stdio.h>
    
    int main(){
        print("hello world\n");
        return 0;
    }
    

### 1.1 信息就是位 + 上下文

hello.c 源程序实际上就是一个由值0和1组成的位（又称为比特）序列，8个位被组织成一组，称为字节。每个字节表示程序中的某些文本字符。像hello.c 这样只由ASCII字符构成的文件称为**文本文件**，所有其他文件都称为二进制文件。

hello.c 的表示法说明了一个基本思想：系统中的所有信息----包括磁盘文件，内存中的程序，内存中的用户数据以及网络上传送的数据。都是由一串比特表示的。区分不同数据对象的唯一方法是我们读到这些数据对象时的**上下文**。比如，在不同的上下文中，一个同样的字节序列可能表示一个整数，浮点数，字符，或者机器指令。

### 1.2 程序被被其他程序翻译成不同的格式。

为了在系统上运行hello.c 程序，每条C语句都必须被其他程序转化为一些类低级机器语言指令。然后这些指令按照一种称为可执行目标程序的格式打包好，并以二级制磁盘文件的形式存放起来。 目标程序也称为**可执行目标文件**。

在Unix系统上，从源文件到目标文件的转化是由编译器驱动程序完成的。

    linux > gcc -o hello hello.c
    

这个编译过程可以分为四个阶段，执行这四个阶段的的程序（预处理器、编译器、汇编器和链接器）一起构成了**编译系统**（compilation system）。

1.  经过**预处理器（cpp）**处理生成**修改了的源程序**（文本）；
2.  经过**编译器（ccl）**处理生成**汇编程序**（文本）；
3.  经过**汇编器（as）**处理生成**可重定位目标程序**（二进制）；
4.  经过**连接器(ld)**处理最终生成**可执行目标程序**（二进制）；

### 1.3 了解编译系统如何工作是大有益处的

*   优化程序性能；
    
    我们确实需要了解一些机器代码以及编译器将不同c语句转化为机器代码的方式。比如一个switch语句是否总比一个if-else语句更高效...
    
*   理解连接时出现的错误；
    
*   避免安全漏洞；
    
    多年来，缓冲区溢出错误是造成大多数网络和Internet服务器上安全漏洞的主要原因。存在这些错误的原因是因为很少有程序员能够理解需要限制从不受信任的源接收的数据的数量和格式。学习安全编程的第一步就是理解数据和控制信息存储在程序栈上的方式会引起的后果。